(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[451],{5377:(e,s,t)=>{Promise.resolve().then(t.bind(t,7610))},7610:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l});var r=t(5155),a=t(2115);function l(){var e,s;let[t,l]=(0,a.useState)([]),[n,i]=(0,a.useState)(null),[c,d]=(0,a.useState)([]),[o,x]=(0,a.useState)(""),[m,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{u()},[]),(0,a.useEffect)(()=>{n&&f(n)},[n]);let u=async()=>{try{let e=await fetch("/api/messages");if(e.ok){let s=await e.json();l(s.conversations||[])}}catch(e){console.error("Error fetching conversations:",e)}finally{h(!1)}},f=async e=>{try{let s=await fetch("/api/messages?with=".concat(e));if(s.ok){let e=await s.json();d(e.messages||[])}}catch(e){console.error("Error fetching messages:",e)}},p=async e=>{if(e.preventDefault(),o.trim()&&n)try{(await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({receiverId:n,content:o.trim()})})).ok&&(x(""),f(n),u())}catch(e){console.error("Error sending message:",e)}};return m?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-600/20 via-indigo-600/20 to-purple-600/20",children:(0,r.jsx)("div",{className:"w-full py-6 px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-md rounded-lg shadow-xl border border-white/20 overflow-hidden",style:{height:"calc(100vh - 200px)"},children:(0,r.jsxs)("div",{className:"flex h-full",children:[(0,r.jsxs)("div",{className:"w-1/3 border-r border-white/20",children:[(0,r.jsx)("div",{className:"p-4 border-b border-white/20",children:(0,r.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Messages"})}),(0,r.jsx)("div",{className:"overflow-y-auto h-full",children:0===t.length?(0,r.jsxs)("div",{className:"p-4 text-center text-white/70",children:[(0,r.jsx)("p",{children:"No conversations yet"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:"Connect with founders to start messaging"})]}):t.map(e=>(0,r.jsx)("div",{onClick:()=>i(e.partner.id),className:"p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 ".concat(n===e.partner.id?"bg-blue-50 border-blue-200":""),children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold",children:e.partner.fullName.charAt(0)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.partner.fullName}),e.unreadCount>0&&(0,r.jsx)("span",{className:"bg-blue-600 text-white text-xs rounded-full px-2 py-1",children:e.unreadCount})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 truncate",children:e.latestMessage.content}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:new Date(e.latestMessage.createdAt).toLocaleDateString()})]})]})},e.partner.id))})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col",children:n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:null==(e=t.find(e=>e.partner.id===n))?void 0:e.partner.fullName.charAt(0)}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:null==(s=t.find(e=>e.partner.id===n))?void 0:s.partner.fullName})})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:c.map(e=>(0,r.jsx)("div",{className:"flex ".concat(e.senderId===n?"justify-start":"justify-end"),children:(0,r.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg ".concat(e.senderId===n?"bg-gray-200 text-gray-900":"bg-blue-600 text-white"),children:[(0,r.jsx)("p",{className:"text-sm",children:e.content}),(0,r.jsx)("p",{className:"text-xs mt-1 ".concat(e.senderId===n?"text-gray-500":"text-blue-100"),children:new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},e.id))}),(0,r.jsx)("form",{onSubmit:p,className:"p-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("input",{type:"text",value:o,onChange:e=>x(e.target.value),placeholder:"Type a message...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"}),(0,r.jsx)("button",{type:"submit",disabled:!o.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Select a conversation"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Choose a conversation from the list to start messaging."})]})})})]})})})})}}},e=>{e.O(0,[441,964,358],()=>e(e.s=5377)),_N_E=e.O()}]);